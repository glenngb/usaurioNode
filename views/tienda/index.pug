doctype html
html
  head
    meta(charset="UTF-8")
    meta(name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no")
    title Productos - Tienda
    // Enlace a Bootstrap 4.5.2
    link(rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css")
    link(rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css")
    link(rel="stylesheet" href="/css/style.css")
    
    style.
      .product-img-container {
        width: 100%;
        height: 200px;
        overflow: hidden;
        display: flex;
        justify-content: center;
        align-items: center;
      }
      .product-img {
        width: 100%;
        height: 100%;
        object-fit: cover; /* Mantiene la relación de aspecto sin distorsionar la imagen */
      }
      .cart-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 0.5em 0;
        border-bottom: 1px solid #ddd;
      }
      .cart-item button {
        margin-left: 10px;
      }

  body
    // Navbar
    nav.navbar.navbar-expand-lg.navbar-light.bg-light
      .container
        a.navbar-brand(href="#") Electronik3000
        button.navbar-toggler(type="button", data-toggle="collapse", data-target="#navbarNav", aria-controls="navbarNav", aria-expanded="false", aria-label="Toggle navigation")
          span.navbar-toggler-icon
        .collapse.navbar-collapse(id="navbarNav")
          ul.navbar-nav.ml-auto
            if usuario
              li.nav-item
                a.nav-link(href="#") Hola: #{usuario.correo}
              li.nav-item
                a.nav-link.text-black(href="#", data-toggle="modal", data-target="#cartModal") 
                i.fas.fa-cart-shopping.mr-2
                  span#cart-count.badge.badge-pill.badge-primary 0
                    | Carrito
              li.nav-item
                a.nav-link.text-red(href="/logout") 
                  i.fas.fa-right-from-bracket.mr-2
                  | Cerrar Sesión
            else
              li.nav-item
                a.nav-link(href="/login") Iniciar Sesión
            li.nav-item
              a.nav-link(href="#") Contacto

    .container
      h1.text-center.mt-4.mb-4 Productos

      .row
        each producto in productos
          .col-md-4.mb-4
            .card
              // Muestra la imagen del producto si existe, o una imagen predeterminada
              .product-img-container
                if producto.imagen
                  img.product-img(src=`/${producto.imagen}`, alt=producto.nombre)
                else
                  img.product-img(src='/images/default-product.jpg', alt='Producto sin imagen')
                
              .card-body
                h5.card-title= producto.nombre
                p.card-text= producto.descripcion
                p.font-weight-bold Precio: $ #{producto.precio}
                form(action=`/carrito/agregar/${producto.id}`, method="post")
                  button.btn.btn-primary(type="submit") Agregar al Carrito

    // Sección para mostrar el carrito de compras
    .container.mt-4
      h2 Carrito de Compras
      #cart-container
      p#cart-total Total: $0

      <!-- Modal Carrito de Compras -->
<div class="modal fade" id="cartModal" tabindex="-1" role="dialog" aria-labelledby="cartModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="cartModalLabel">Resumen del Carrito</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Cerrar">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <div id="cart-summary">
          <!-- Aquí se mostrará el resumen del carrito -->
        </div>
        <p id="cart-total-modal">Total: $0</p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cerrar</button>
        <button type="button" class="btn btn-danger" id="clear-cart">Eliminar Carrito</button>
        <button type="button" class="btn btn-primary" id="checkout">Pagar</button>
      </div>
    </div>
  </div>
</div>


    // Scripts
    script(src="https://code.jquery.com/jquery-3.5.1.slim.min.js")
    script(src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.2/dist/js/bootstrap.bundle.min.js")
    script(src="/js/script.js") // Enlace al archivo de JavaScript para el carrito
